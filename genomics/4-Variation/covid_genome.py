# -*- coding: utf-8 -*-

import logging
from urllib.parse import urljoin

import click
import bioblend.galaxy

from workflow2executable.invocations import InvocationMonitor

log = logging.Logger(__name__)
log.setLevel(logging.INFO)
# create a console handler with INFO loglevel
ch = logging.StreamHandler()
ch.setLevel(logging.INFO)
log.addHandler(ch)

FULL_WORKFLOW = {'a_galaxy_workflow': 'true', 'annotation': 'Downloads reads from SRA and runs SE and PE COVID-19 variation workflows', 'format-version': '0.1', 'name': 'Download and SE+PE Illumina Covid Variation Workflow', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'NC_45512 GenBank file'}], 'label': 'NC_45512 GenBank file', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 199.99996948242188, 'top': 200.00000762939453}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': '1fb63d20-1e82-4dd5-be90-96bda9fa008e', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '54957b29-f715-49e1-9aaa-01902247d562'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Accessions file'}], 'label': 'Accessions file', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 199.99996948242188, 'top': 309.0056838989258}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': 'ec09553d-71a0-41fa-9fe0-3942c9c6df04', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'feb3dc0a-1f8a-4beb-be97-dac147bdcc49'}]}, '2': {'annotation': '', 'id': 2, 'input_connections': {'Accessions': {'id': 1, 'input_subworkflow_step_id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'Parallel accession download Illumina', 'outputs': [], 'position': {'left': 486.0085144042969, 'top': 200.00000762939453}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'Parallel accession download Illumina', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Accessions'}], 'label': 'Accessions', 'name': 'Input dataset', 'outputs': [], 'position': {'bottom': 582.3579368591309, 'height': 60.96590805053711, 'left': 379.4317932128906, 'right': 589.4317932128906, 'top': 521.3920288085938, 'width': 210, 'x': 379.4317932128906, 'y': 521.3920288085938}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': 'd97351ae-3074-4c96-81bb-035e77e4dd9e', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '3d6c6834-9d67-4674-be2a-44d8b1303297'}]}, '1': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.4.0', 'errors': None, 'id': 1, 'input_connections': {'split_parms|input': {'id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'Split file', 'outputs': [{'name': 'list_output_txt', 'type': 'input'}], 'position': {'bottom': 766.3636016845703, 'height': 111.96022033691406, 'left': 449.94317626953125, 'right': 659.9431762695312, 'top': 654.4033813476562, 'width': 210, 'x': 449.94317626953125, 'y': 654.4033813476562}, 'post_job_actions': {'HideDatasetActionlist_output_txt': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'list_output_txt'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/bgruening/split_file_to_collection/split_file_to_collection/0.4.0', 'tool_shed_repository': {'changeset_revision': 'e77b954f0da5', 'name': 'split_file_to_collection', 'owner': 'bgruening', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"split_parms": {"select_ftype": "txt", "__current_case__": 5, "input": {"__class__": "ConnectedValue"}, "select_mode": {"mode": "chunk", "__current_case__": 0, "chunksize": "1"}, "newfilenames": "split_file", "select_allocate": {"allocate": "byrow", "__current_case__": 2}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '08bf3c9c-35fc-40f3-a494-d6d74901767b', 'workflow_outputs': []}, '2': {'annotation': '', 'content_id': 'param_value_from_file', 'errors': None, 'id': 2, 'input_connections': {'input1': {'id': 1, 'output_name': 'list_output_txt'}}, 'inputs': [], 'label': None, 'name': 'Parse parameter value', 'outputs': [{'name': 'text_param', 'type': 'expression.json'}], 'position': {'bottom': 633.3522491455078, 'height': 151.96022033691406, 'left': 641.4488525390625, 'right': 851.4488525390625, 'top': 481.39202880859375, 'width': 210, 'x': 641.4488525390625, 'y': 481.39202880859375}, 'post_job_actions': {}, 'tool_id': 'param_value_from_file', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "param_type": "text", "remove_newlines": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '570d0317-259f-42b1-91f4-74f050e754b5', 'workflow_outputs': [{'label': None, 'output_name': 'text_param', 'uuid': 'ea4c572b-7a61-4da4-86d8-59c6232ad304'}]}, '3': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/2.10.7+galaxy0', 'errors': None, 'id': 3, 'input_connections': {'input|accession': {'id': 2, 'output_name': 'text_param'}}, 'inputs': [], 'label': None, 'name': 'Faster Download and Extract Reads in FASTQ', 'outputs': [{'name': 'list_paired', 'type': 'input'}, {'name': 'output_collection', 'type': 'input'}, {'name': 'output_collection_other', 'type': 'input'}, {'name': 'log', 'type': 'txt'}], 'position': {'bottom': 844.3323364257812, 'height': 261.960205078125, 'left': 908.3522338867188, 'right': 1118.3522338867188, 'top': 582.3721313476562, 'width': 210, 'x': 908.3522338867188, 'y': 582.3721313476562}, 'post_job_actions': {'HideDatasetActionlist_paired': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'list_paired'}, 'HideDatasetActionlog': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'log'}, 'HideDatasetActionoutput_collection': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_collection'}, 'HideDatasetActionoutput_collection_other': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_collection_other'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/sra_tools/fasterq_dump/2.10.7+galaxy0', 'tool_shed_repository': {'changeset_revision': '7068f48d0ef9', 'name': 'sra_tools', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"adv": {"minlen": "", "split": "--split-3", "skip_technical": "true"}, "input": {"input_select": "accession_number", "__current_case__": 0, "accession": {"__class__": "ConnectedValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '4234ee7a-83c8-4365-ae89-a676e10a8ef0', 'workflow_outputs': []}, '4': {'annotation': '', 'content_id': '__APPLY_RULES__', 'errors': None, 'id': 4, 'input_connections': {'input': {'id': 3, 'output_name': 'list_paired'}}, 'inputs': [], 'label': None, 'name': 'Apply Rule to Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'bottom': 739.3323516845703, 'height': 131.96022033691406, 'left': 1245.411865234375, 'right': 1455.411865234375, 'top': 607.3721313476562, 'width': 210, 'x': 1245.411865234375, 'y': 607.3721313476562}, 'post_job_actions': {'TagDatasetActionoutput': {'action_arguments': {'tags': 'name:PE'}, 'action_type': 'TagDatasetAction', 'output_name': 'output'}}, 'tool_id': '__APPLY_RULES__', 'tool_state': '{"input": {"__class__": "ConnectedValue"}, "rules": {"mapping": [{"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [1], "connectable": true, "editing": false, "is_workflow": false, "type": "list_identifiers"}, {"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [2], "connectable": true, "is_workflow": false, "type": "paired_identifier"}], "rules": [{"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier0", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier1", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier2", "warn": null}]}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '27632fd5-8451-4979-8dcc-f2b2d3c384bf', 'workflow_outputs': [{'label': 'Paired End Illumina Reads', 'output_name': 'output', 'uuid': 'fa9cd051-7f1e-4654-93bb-5dc8d715332b'}]}, '5': {'annotation': '', 'content_id': '__APPLY_RULES__', 'errors': None, 'id': 5, 'input_connections': {'input': {'id': 3, 'output_name': 'output_collection'}}, 'inputs': [], 'label': None, 'name': 'Apply Rule to Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'bottom': 875.3834991455078, 'height': 131.96022033691406, 'left': 1242.4573974609375, 'right': 1452.4573974609375, 'top': 743.4232788085938, 'width': 210, 'x': 1242.4573974609375, 'y': 743.4232788085938}, 'post_job_actions': {'TagDatasetActionoutput': {'action_arguments': {'tags': 'name:SE'}, 'action_type': 'TagDatasetAction', 'output_name': 'output'}}, 'tool_id': '__APPLY_RULES__', 'tool_state': '{"input": {"__class__": "ConnectedValue"}, "rules": {"mapping": [{"collapsible_value": {"__class__": "RuntimeValue"}, "columns": [1], "connectable": true, "editing": false, "is_workflow": false, "type": "list_identifiers"}], "rules": [{"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier0", "warn": null}, {"collapsible_value": {"__class__": "RuntimeValue"}, "connectable": true, "error": null, "is_workflow": false, "type": "add_column_metadata", "value": "identifier1", "warn": null}]}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '0a588cdc-547d-408f-9739-259af2f535c9', 'workflow_outputs': [{'label': 'Single End Illumina Reads', 'output_name': 'output', 'uuid': 'cebc1701-8524-469e-8e70-db14327264e8'}]}}, 'tags': '', 'uuid': 'b81f4a41-efa6-4244-a49d-73cbba1caf37'}, 'tool_id': '0cb86bd67074214a', 'type': 'subworkflow', 'uuid': 'd7822ea1-e712-4eec-9e66-d4b2fb15d435', 'workflow_outputs': [{'label': None, 'output_name': 'Paired End Illumina Reads', 'uuid': 'a587156d-9012-40ed-bdbc-996ac368ee7a'}, {'label': None, 'output_name': 'Single End Illumina Reads', 'uuid': 'af4d59ac-d78c-4d14-aabf-2dc19576a77f'}, {'label': None, 'output_name': '2:text_param', 'uuid': '9bb17aeb-6a7d-47f1-b5cf-f060e9b0417f'}]}, '3': {'annotation': '', 'id': 3, 'input_connections': {'GenBank file ': {'id': 0, 'input_subworkflow_step_id': 0, 'output_name': 'output'}, 'Paired Collection (fastqsanger)': {'id': 2, 'input_subworkflow_step_id': 1, 'output_name': 'Paired End Illumina Reads'}}, 'inputs': [], 'label': None, 'name': 'COVID-19 - PE Variation', 'outputs': [], 'position': {'left': 772.0169982910156, 'top': 200.00000762939453}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'COVID-19 - PE Variation', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'GenBank file '}], 'label': 'GenBank file ', 'name': 'Input dataset', 'outputs': [], 'position': {'left': 360.1363830566406, 'top': 400.03406524658203}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': '780a4bb5-683d-4b8f-b41a-e7f8eb6bc2b0', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'c1e07988-e73b-49e1-a7c0-4acdf2512989'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Paired Collection (fastqsanger)'}], 'label': 'Paired Collection (fastqsanger)', 'name': 'Input dataset collection', 'outputs': [], 'position': {'left': 360.1363830566406, 'top': 471.2386245727539}, 'tool_id': None, 'tool_state': '{"optional": false, "collection_type": "list:paired"}', 'tool_version': None, 'type': 'data_collection_input', 'uuid': 'df119f8f-9f51-4a4f-b714-e5dbd88a33e1', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '43ce0c2a-230a-489f-940e-2eb0497de658'}]}, '2': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'errors': None, 'id': 2, 'input_connections': {'input_type|input_gbk': {'id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'SnpEff build:', 'outputs': [{'name': 'snpeff_output', 'type': 'snpeffdb'}, {'name': 'output_fasta', 'type': 'fasta'}], 'position': {'left': 588.9999694824219, 'top': 400.03406524658203}, 'post_job_actions': {'RenameDatasetActionsnpeff_output': {'action_arguments': {'newname': 'SpnEFF4.3 database for nCov'}, 'action_type': 'RenameDatasetAction', 'output_name': 'snpeff_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'tool_shed_repository': {'changeset_revision': '74aebe30fb52', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"codon_table": "Standard", "genome_version": "ncov", "input_type": {"input_type_selector": "gb", "__current_case__": 0, "input_gbk": {"__class__": "ConnectedValue"}, "fasta": "yes", "remove_version": "true"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '4.3+T.galaxy4', 'type': 'tool', 'uuid': 'e7273ae9-ff9e-471b-b67e-443a28f01b8e', 'workflow_outputs': [{'label': 'SpnEFF4.3 database for ncov', 'output_name': 'snpeff_output', 'uuid': '4ff58dd3-d503-4e0d-b57a-f8da4dee7b3d'}, {'label': 'Fasta sequence for nCov', 'output_name': 'output_fasta', 'uuid': '3e2c3b4d-17b1-4c00-9b6d-b0ff3bb4621a'}]}, '3': {'annotation': '', 'content_id': '__UNZIP_COLLECTION__', 'errors': None, 'id': 3, 'input_connections': {'input': {'id': 1, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'Unzip Collection', 'outputs': [{'name': 'forward', 'type': 'input'}, {'name': 'reverse', 'type': 'input'}], 'position': {'left': 588.9999694824219, 'top': 567.9999771118164}, 'post_job_actions': {}, 'tool_id': '__UNZIP_COLLECTION__', 'tool_state': '{"input": {"__class__": "ConnectedValue"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.0.0', 'type': 'tool', 'uuid': '2d05730e-b513-4815-9c87-866e5d2c3e17', 'workflow_outputs': [{'label': 'input dataset(s) (reverse)', 'output_name': 'reverse', 'uuid': '8779a9fa-2e57-4628-9f53-8da2383cec9d'}, {'label': 'input dataset(s) (forward)', 'output_name': 'forward', 'uuid': 'e2930dad-3218-4511-b3c7-c85a85d67710'}]}, '4': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'errors': None, 'id': 4, 'input_connections': {'single_paired|in1': {'id': 3, 'output_name': 'forward'}, 'single_paired|in2': {'id': 3, 'output_name': 'reverse'}}, 'inputs': [{'description': 'runtime parameter for tool fastp', 'name': 'single_paired'}, {'description': 'runtime parameter for tool fastp', 'name': 'single_paired'}], 'label': None, 'name': 'fastp', 'outputs': [{'name': 'out1', 'type': 'input'}, {'name': 'out2', 'type': 'input'}, {'name': 'report_html', 'type': 'html'}, {'name': 'report_json', 'type': 'json'}], 'position': {'left': 884.2044982910156, 'top': 647.2499771118164}, 'post_job_actions': {'HideDatasetActionout1': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'out1'}, 'HideDatasetActionout2': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'out2'}, 'HideDatasetActionreport_html': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_html'}, 'HideDatasetActionreport_json': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_json'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'tool_shed_repository': {'changeset_revision': 'dbf9c561ef29', 'name': 'fastp', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filter_options": {"quality_filtering_options": {"disable_quality_filtering": "false", "qualified_quality_phred": "", "unqualified_percent_limit": "", "n_base_limit": ""}, "length_filtering_options": {"disable_length_filtering": "false", "length_required": "", "length_limit": ""}, "low_complexity_filter": {"enable_low_complexity_filter": "false", "complexity_threshold": ""}}, "output_options": {"report_html": "true", "report_json": "true"}, "overrepresented_sequence_analysis": {"overrepresentation_analysis": "false", "overrepresentation_sampling": ""}, "read_mod_options": {"polyg_tail_trimming": {"trimming_select": "", "__current_case__": 1, "poly_g_min_len": ""}, "polyx_tail_trimming": {"polyx_trimming_select": "", "__current_case__": 1}, "umi_processing": {"umi": "false", "umi_loc": "", "umi_len": "", "umi_prefix": ""}, "cutting_by_quality_options": {"cut_by_quality5": "false", "cut_by_quality3": "false", "cut_window_size": "", "cut_mean_quality": ""}, "base_correction_options": {"correction": "false"}}, "single_paired": {"single_paired_selector": "paired", "__current_case__": 1, "in1": {"__class__": "RuntimeValue"}, "in2": {"__class__": "RuntimeValue"}, "adapter_trimming_options": {"disable_adapter_trimming": "false", "adapter_sequence1": "", "adapter_sequence2": ""}, "global_trimming_options": {"trim_front1": "", "trim_tail1": "", "trim_front2": "", "trim_tail2": ""}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '0.20.1+galaxy0', 'type': 'tool', 'uuid': '485a549c-1033-49ce-905f-919dec28567d', 'workflow_outputs': []}, '5': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1', 'errors': None, 'id': 5, 'input_connections': {'fastq_input|fastq_input1': {'id': 4, 'output_name': 'out1'}, 'fastq_input|fastq_input2': {'id': 4, 'output_name': 'out2'}, 'reference_source|ref_file': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [{'description': 'runtime parameter for tool Map with BWA-MEM', 'name': 'fastq_input'}, {'description': 'runtime parameter for tool Map with BWA-MEM', 'name': 'fastq_input'}, {'description': 'runtime parameter for tool Map with BWA-MEM', 'name': 'reference_source'}], 'label': None, 'name': 'Map with BWA-MEM', 'outputs': [{'name': 'bam_output', 'type': 'bam'}], 'position': {'left': 1182.7840881347656, 'top': 780.0340347290039}, 'post_job_actions': {'HideDatasetActionbam_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'bam_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa_mem/0.7.17.1', 'tool_shed_repository': {'changeset_revision': '01ac0a5fedc3', 'name': 'bwa', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"analysis_type": {"analysis_type_selector": "illumina", "__current_case__": 0}, "fastq_input": {"fastq_input_selector": "paired", "__current_case__": 0, "fastq_input1": {"__class__": "RuntimeValue"}, "fastq_input2": {"__class__": "RuntimeValue"}, "iset_stats": ""}, "reference_source": {"reference_source_selector": "history", "__current_case__": 1, "ref_file": {"__class__": "RuntimeValue"}, "index_a": "auto"}, "rg": {"rg_selector": "do_not_set", "__current_case__": 3}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '0.7.17.1', 'type': 'tool', 'uuid': '76ee1f68-fe4e-41d3-82cf-99f70a36142e', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtool_filter2/samtool_filter2/1.8+galaxy1', 'errors': None, 'id': 6, 'input_connections': {'input1': {'id': 5, 'output_name': 'bam_output'}}, 'inputs': [{'description': 'runtime parameter for tool Filter SAM or BAM, output SAM or BAM', 'name': 'bed_file'}], 'label': None, 'name': 'Filter SAM or BAM, output SAM or BAM', 'outputs': [{'name': 'output1', 'type': 'sam'}], 'position': {'left': 975.5908508300781, 'top': 377.9999771118164}, 'post_job_actions': {'HideDatasetActionoutput1': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtool_filter2/samtool_filter2/1.8+galaxy1', 'tool_shed_repository': {'changeset_revision': '649a225999a5', 'name': 'samtool_filter2', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"bed_file": {"__class__": "RuntimeValue"}, "flag": {"filter": "yes", "__current_case__": 1, "reqBits": ["0x0001", "0x0002"], "skipBits": null}, "header": "-h", "input1": {"__class__": "ConnectedValue"}, "library": "", "mapq": "20", "outputtype": "bam", "possibly_select_inverse": "false", "read_group": "", "regions": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.8+galaxy1', 'type': 'tool', 'uuid': 'b83a2d5c-9089-4c8b-8152-03076637284c', 'workflow_outputs': []}, '7': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.2+galaxy2', 'errors': None, 'id': 7, 'input_connections': {'input': {'id': 6, 'output_name': 'output1'}}, 'inputs': [], 'label': None, 'name': 'Samtools stats', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'left': 1228.4090881347656, 'top': 340.9886245727539}, 'post_job_actions': {'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.2+galaxy2', 'tool_shed_repository': {'changeset_revision': '145f6d74ff5e', 'name': 'samtools_stats', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"addref_cond": {"addref_select": "no", "__current_case__": 0}, "cond_region": {"select_region": "no", "__current_case__": 0}, "cov_threshold": "", "coverage_cond": {"coverage_select": "no", "__current_case__": 0}, "filter_by_flags": {"filter_flags": "nofilter", "__current_case__": 1}, "gc_depth": "", "input": {"__class__": "ConnectedValue"}, "insert_size": "", "most_inserts": "", "read_length": "", "remove_dups": "false", "remove_overlaps": "false", "sparse": "false", "split_output_cond": {"split_output_selector": "no", "__current_case__": 0}, "trim_quality": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '2.0.2+galaxy2', 'type': 'tool', 'uuid': '88e7e79e-5416-459f-a4f7-7b2b0866758f', 'workflow_outputs': []}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'errors': None, 'id': 8, 'input_connections': {'inputFile': {'id': 6, 'output_name': 'output1'}}, 'inputs': [], 'label': None, 'name': 'MarkDuplicates', 'outputs': [{'name': 'metrics_file', 'type': 'txt'}, {'name': 'outFile', 'type': 'bam'}], 'position': {'left': 1252.4090881347656, 'top': 526.0454483032227}, 'post_job_actions': {'HideDatasetActionmetrics_file': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'metrics_file'}, 'HideDatasetActionoutFile': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'outFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'tool_shed_repository': {'changeset_revision': 'a1f0b3f4b781', 'name': 'picard', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"assume_sorted": "true", "barcode_tag": "", "comments": [], "duplicate_scoring_strategy": "SUM_OF_BASE_QUALITIES", "inputFile": {"__class__": "ConnectedValue"}, "optical_duplicate_pixel_distance": "100", "read_name_regex": "", "remove_duplicates": "true", "validation_stringency": "LENIENT", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '2.18.2.2', 'type': 'tool', 'uuid': '7683a81a-c14e-4383-8236-8fd79b13986f', 'workflow_outputs': []}, '9': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'errors': None, 'id': 9, 'input_connections': {'reads': {'id': 8, 'output_name': 'outFile'}, 'reference_source|ref': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Realign reads', 'outputs': [{'name': 'realigned', 'type': 'bam'}], 'position': {'left': 1433.4089660644531, 'top': 302.9886245727539}, 'post_job_actions': {'HideDatasetActionrealigned': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'realigned'}, 'RenameDatasetActionrealigned': {'action_arguments': {'newname': 'Realigned Alignments'}, 'action_type': 'RenameDatasetAction', 'output_name': 'realigned'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'cdaab621d454', 'name': 'lofreq_viterbi', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"adv_options": {"delflags": "true", "bq2_handling": {"replace_bq2": "keep", "__current_case__": 0, "defqual": "2"}}, "reads": {"__class__": "ConnectedValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '2.1.3.1+galaxy1', 'type': 'tool', 'uuid': '4a6ce41b-a3b8-4cb6-9b22-151c804a93ee', 'workflow_outputs': []}, '10': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'errors': None, 'id': 10, 'input_connections': {'results_0|software_cond|input': {'id': 4, 'output_name': 'report_json'}, 'results_1|software_cond|output_0|type|input': {'id': 7, 'output_name': 'output'}, 'results_2|software_cond|output_0|input': {'id': 8, 'output_name': 'metrics_file'}}, 'inputs': [], 'label': None, 'name': 'MultiQC', 'outputs': [{'name': 'stats', 'type': 'input'}, {'name': 'plots', 'type': 'input'}, {'name': 'html_report', 'type': 'html'}], 'position': {'left': 1503.4089660644531, 'top': 551.9999771118164}, 'post_job_actions': {'HideDatasetActionplots': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'plots'}, 'HideDatasetActionstats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'stats'}, 'RenameDatasetActionhtml_report': {'action_arguments': {'newname': 'MultiQC Report PE'}, 'action_type': 'RenameDatasetAction', 'output_name': 'html_report'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'tool_shed_repository': {'changeset_revision': '3d93dd18d9f8', 'name': 'multiqc', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"comment": "", "flat": "false", "results": [{"__index__": 0, "software_cond": {"software": "fastp", "__current_case__": 7, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 1, "software_cond": {"software": "samtools", "__current_case__": 22, "output": [{"__index__": 0, "type": {"type": "stats", "__current_case__": 0, "input": {"__class__": "ConnectedValue"}}}]}}, {"__index__": 2, "software_cond": {"software": "picard", "__current_case__": 17, "output": [{"__index__": 0, "type": "markdups", "input": {"__class__": "ConnectedValue"}}]}}], "saveLog": "false", "title": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.7.1', 'type': 'tool', 'uuid': '6fcc09b2-7c2a-43e4-bd2a-c06fcdfbfafb', 'workflow_outputs': [{'label': 'MultiQC Report PE', 'output_name': 'html_report', 'uuid': 'e4f3c1af-da7f-4732-90b6-31b525e1ef9e'}]}, '11': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/2.1.4+galaxy0', 'errors': None, 'id': 11, 'input_connections': {'reads': {'id': 9, 'output_name': 'realigned'}, 'strategy|reference_source|ref': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Insert indel qualities', 'outputs': [{'name': 'output', 'type': 'bam'}], 'position': {'left': 1652.2613830566406, 'top': 335.02271270751953}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Realigned Alignments with Indel Qualities'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/2.1.4+galaxy0', 'tool_shed_repository': {'changeset_revision': 'c27549b9aa1f', 'name': 'lofreq_indelqual', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"reads": {"__class__": "ConnectedValue"}, "strategy": {"selector": "dindel", "__current_case__": 1, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '2.1.4+galaxy0', 'type': 'tool', 'uuid': '236d5bd2-308e-4b82-860c-6293678ed6a7', 'workflow_outputs': [{'label': 'Realigned Alignments with Indel Qualities', 'output_name': 'output', 'uuid': 'a71b5a4e-0cd7-4914-ac1a-4dedfdcecea1'}]}, '12': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy0', 'errors': None, 'id': 12, 'input_connections': {'reads': {'id': 11, 'output_name': 'output'}, 'reference_source|ref': {'id': 2, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Call variants', 'outputs': [{'name': 'variants', 'type': 'vcf'}], 'position': {'left': 1929.2613830566406, 'top': 353.02271270751953}, 'post_job_actions': {'HideDatasetActionvariants': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'variants'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy0', 'tool_shed_repository': {'changeset_revision': '03627f24605f', 'name': 'lofreq_call', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__job_resource": {"__current_case__": 0, "__job_resource__select": "no"}, "call_control": {"set_call_options": "yes", "__current_case__": 1, "coverage": {"min_cov": "50", "max_depth": "1000000"}, "pe": {"use_orphan": "false"}, "bc_quals": {"min_bq": "30", "min_alt_bq": "30", "def_alt_bq": "0"}, "align_quals": {"alnqual": {"use_alnqual": "", "__current_case__": 0, "alnqual_choice": {"alnquals_to_use": "", "__current_case__": 1, "extended_baq": "true"}}}, "map_quals": {"min_mq": "20", "use_mq": {"no_mq": "", "__current_case__": 0, "max_mq": "255"}}, "source_qual": {"use_src_qual": {"src_qual": "", "__current_case__": 0}}, "joint_qual": {"min_jq": "0", "min_alt_jq": "0", "def_alt_jq": "0"}}, "filter_control": {"filter_type": "set_lofreq_standard", "__current_case__": 2, "sig": "0.01", "bonf": "dynamic", "others": ""}, "reads": {"__class__": "ConnectedValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "ConnectedValue"}}, "regions": {"restrict_to_region": "genome", "__current_case__": 0}, "variant_types": "--call-indels", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '2.1.3.1+galaxy0', 'type': 'tool', 'uuid': 'fb7a883a-e7ff-42af-86d9-182c58573463', 'workflow_outputs': []}, '13': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'errors': None, 'id': 13, 'input_connections': {'input': {'id': 12, 'output_name': 'variants'}, 'snpDb|snpeff_db': {'id': 2, 'output_name': 'snpeff_output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff eff:', 'name': 'intervals'}, {'description': 'runtime parameter for tool SnpEff eff:', 'name': 'transcripts'}], 'label': None, 'name': 'SnpEff eff:', 'outputs': [{'name': 'snpeff_output', 'type': 'vcf'}, {'name': 'statsFile', 'type': 'html'}], 'position': {'left': 2189.0340881347656, 'top': 400.03406524658203}, 'post_job_actions': {'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}, 'RenameDatasetActionstatsFile': {'action_arguments': {'newname': 'SnpEFF HTML stats'}, 'action_type': 'RenameDatasetAction', 'output_name': 'statsFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'tool_shed_repository': {'changeset_revision': '74aebe30fb52', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"annotations": ["-formatEff", "-classic"], "chr": "", "csvStats": "false", "filter": {"specificEffects": "no", "__current_case__": 0}, "filterOut": ["-no-downstream", "-no-intergenic", "-no-intron", "-no-upstream", "-no-utr"], "generate_stats": "true", "input": {"__class__": "ConnectedValue"}, "inputFormat": "vcf", "intervals": {"__class__": "RuntimeValue"}, "noLog": "true", "offset": "default", "outputConditional": {"outputFormat": "vcf", "__current_case__": 0}, "snpDb": {"genomeSrc": "custom", "__current_case__": 3, "snpeff_db": {"__class__": "ConnectedValue"}, "codon_table": "Standard"}, "spliceRegion": {"setSpliceRegions": "no", "__current_case__": 0}, "spliceSiteSize": null, "transcripts": {"__class__": "RuntimeValue"}, "udLength": "0", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '4.3+T.galaxy1', 'type': 'tool', 'uuid': '43939737-984f-4b29-884c-a72c2ca44fde', 'workflow_outputs': [{'label': 'SnpEFF HTML stats', 'output_name': 'statsFile', 'uuid': 'b14eec10-60b6-45d0-9766-cb651793d8b9'}]}, '14': {'annotation': '', 'content_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'errors': None, 'id': 14, 'input_connections': {'input1': {'id': 13, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'Convert VCF to VCF_BGZIP', 'outputs': [{'name': 'output1', 'type': 'vcf_bgzip'}], 'position': {'left': 2417.8634338378906, 'top': 400.03406524658203}, 'post_job_actions': {'RenameDatasetActionoutput1': {'action_arguments': {'newname': 'SnpEff vcf.gz'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.0.2', 'type': 'tool', 'uuid': '474d1281-4d38-486b-a1ae-c2984f146eff', 'workflow_outputs': [{'label': 'SnpEff vcf.gz', 'output_name': 'output1', 'uuid': '7fedd72d-80d1-48c5-988d-d3103782202c'}]}, '15': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'errors': None, 'id': 15, 'input_connections': {'input': {'id': 13, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'SnpSift Extract Fields', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'left': 2417.8634338378906, 'top': 512.0340347290039}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift tabular output'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'tool_shed_repository': {'changeset_revision': '2b3e65a4252f', 'name': 'snpsift', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"empty_text": ".", "extract": "CHROM POS REF ALT QUAL DP AF SB DP4 EFF[*].IMPACT EFF[*].FUNCLASS EFF[*].EFFECT EFF[*].GENE EFF[*].CODON", "input": {"__class__": "ConnectedValue"}, "one_effect_per_line": "false", "separator": ",", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '4.3+t.galaxy0', 'type': 'tool', 'uuid': '97d5c43d-f495-4200-8be9-83d3ae0c6ba4', 'workflow_outputs': [{'label': 'SnpSift tabular output', 'output_name': 'output', 'uuid': '998429c8-49ba-4d15-b2a1-09f8570e665a'}]}}, 'tags': '', 'uuid': 'b2d79261-41ee-432d-8793-760155c99bd2'}, 'tool_id': '7e6b034573e81d24', 'type': 'subworkflow', 'uuid': '340fc460-18bf-4a87-b4c4-d093987937bc', 'workflow_outputs': [{'label': None, 'output_name': 'input dataset(s) (forward)', 'uuid': '4b350dd9-336e-46e1-931c-dbeb62a7ffa5'}, {'label': None, 'output_name': 'input dataset(s) (reverse)', 'uuid': '70bdfe73-1683-4703-a9bf-8246567174ac'}, {'label': None, 'output_name': 'Fasta sequence for nCov', 'uuid': 'd6cd1f62-3a46-45c3-b66c-1682c004e13f'}, {'label': None, 'output_name': 'SpnEFF4.3 database for ncov', 'uuid': '9ed08915-8d3c-4ba5-8bb4-e1b32ee1a762'}, {'label': None, 'output_name': 'SnpEff vcf.gz', 'uuid': 'c296d455-0f2a-478b-9faf-9c1043504935'}, {'label': None, 'output_name': 'SnpEFF HTML stats', 'uuid': 'c3c270d7-e492-4686-aa54-11d16bd153fe'}, {'label': None, 'output_name': 'SnpSift tabular output', 'uuid': '974a732e-c656-46d8-9515-d27270090055'}, {'label': None, 'output_name': 'Realigned Alignments with Indel Qualities', 'uuid': '1721e7d2-1622-4f4b-bb97-843d170bbbbb'}, {'label': None, 'output_name': 'MultiQC Report PE', 'uuid': '8c54c27f-fa22-4776-b446-d87876c3b673'}]}, '4': {'annotation': '', 'id': 4, 'input_connections': {'Genbank file': {'id': 0, 'input_subworkflow_step_id': 1, 'output_name': 'output'}, 'Single End Collection (fastqsanger)': {'id': 2, 'input_subworkflow_step_id': 0, 'output_name': 'Single End Illumina Reads'}}, 'inputs': [], 'label': None, 'name': 'COVID-19 - SE Variation', 'outputs': [], 'position': {'left': 772.0169982910156, 'top': 709.9999771118164}, 'subworkflow': {'a_galaxy_workflow': 'true', 'annotation': '', 'format-version': '0.1', 'name': 'COVID-19 - SE Variation', 'steps': {'0': {'annotation': '', 'content_id': None, 'errors': None, 'id': 0, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Single End Collection (fastqsanger)'}], 'label': 'Single End Collection (fastqsanger)', 'name': 'Input dataset collection', 'outputs': [], 'position': {'bottom': 435.54330825805664, 'height': 60.724430084228516, 'left': 20.617897033691406, 'right': 178.1178970336914, 'top': 374.8188781738281, 'width': 157.5, 'x': 20.617897033691406, 'y': 374.8188781738281}, 'tool_id': None, 'tool_state': '{"optional": false, "collection_type": "list"}', 'tool_version': None, 'type': 'data_collection_input', 'uuid': 'd6dbc6a5-b7d6-4e98-8102-983dc776d37b', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': '30935d67-3b3f-4eb5-9fc1-1a120118c29e'}]}, '1': {'annotation': '', 'content_id': None, 'errors': None, 'id': 1, 'input_connections': {}, 'inputs': [{'description': '', 'name': 'Genbank file'}], 'label': 'Genbank file', 'name': 'Input dataset', 'outputs': [], 'position': {'bottom': 502.29758071899414, 'height': 45.724430084228516, 'left': 20.617897033691406, 'right': 178.1178970336914, 'top': 456.5731506347656, 'width': 157.5, 'x': 20.617897033691406, 'y': 456.5731506347656}, 'tool_id': None, 'tool_state': '{"optional": false}', 'tool_version': None, 'type': 'data_input', 'uuid': '2726f03d-e8e3-4871-91d5-a2cec5377459', 'workflow_outputs': [{'label': None, 'output_name': 'output', 'uuid': 'd06894cd-cac9-40aa-961d-21edc5b5f17e'}]}, '2': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'errors': None, 'id': 2, 'input_connections': {'single_paired|in1': {'id': 0, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'fastp', 'outputs': [{'name': 'out1', 'type': 'input'}, {'name': 'report_html', 'type': 'html'}, {'name': 'report_json', 'type': 'json'}], 'position': {'bottom': 533.7890472412109, 'height': 158.9701690673828, 'left': 236.6690216064453, 'right': 394.1690216064453, 'top': 374.8188781738281, 'width': 157.5, 'x': 236.6690216064453, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionout1': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'out1'}, 'HideDatasetActionreport_html': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_html'}, 'HideDatasetActionreport_json': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'report_json'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/fastp/fastp/0.20.1+galaxy0', 'tool_shed_repository': {'changeset_revision': 'dbf9c561ef29', 'name': 'fastp', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filter_options": {"quality_filtering_options": {"disable_quality_filtering": "false", "qualified_quality_phred": "", "unqualified_percent_limit": "", "n_base_limit": ""}, "length_filtering_options": {"disable_length_filtering": "false", "length_required": "", "length_limit": ""}, "low_complexity_filter": {"enable_low_complexity_filter": "false", "complexity_threshold": ""}}, "output_options": {"report_html": "true", "report_json": "true"}, "overrepresented_sequence_analysis": {"overrepresentation_analysis": "false", "overrepresentation_sampling": ""}, "read_mod_options": {"polyg_tail_trimming": {"trimming_select": "", "__current_case__": 1, "poly_g_min_len": ""}, "polyx_tail_trimming": {"polyx_trimming_select": "", "__current_case__": 1}, "umi_processing": {"umi": "false", "umi_loc": "", "umi_len": "", "umi_prefix": ""}, "cutting_by_quality_options": {"cut_by_quality5": "false", "cut_by_quality3": "false", "cut_window_size": "", "cut_mean_quality": ""}, "base_correction_options": {"correction": "false"}}, "single_paired": {"single_paired_selector": "single", "__current_case__": 0, "in1": {"__class__": "ConnectedValue"}, "adapter_trimming_options": {"disable_adapter_trimming": "false", "adapter_sequence1": ""}, "global_trimming_options": {"trim_front1": "", "trim_tail1": ""}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '404bbe5e-9f19-40d2-9a9c-de36d51a2c14', 'workflow_outputs': []}, '3': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'errors': None, 'id': 3, 'input_connections': {'input_type|input_gbk': {'id': 1, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'SnpEff build:', 'outputs': [{'name': 'snpeff_output', 'type': 'snpeffdb'}, {'name': 'output_fasta', 'type': 'fasta'}], 'position': {'bottom': 691.2677154541016, 'height': 136.4701690673828, 'left': 236.6690216064453, 'right': 394.1690216064453, 'top': 554.7975463867188, 'width': 157.5, 'x': 236.6690216064453, 'y': 554.7975463867188}, 'post_job_actions': {'HideDatasetActionoutput_fasta': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output_fasta'}, 'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff_build_gb/4.3+T.galaxy4', 'tool_shed_repository': {'changeset_revision': '268d162b9c49', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"codon_table": "Standard", "genome_version": "covid-19", "input_type": {"input_type_selector": "gb", "__current_case__": 0, "input_gbk": {"__class__": "ConnectedValue"}, "fasta": "yes", "remove_version": "true"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '5d85f428-cccd-4781-bd7e-b1dcd508dcbf', 'workflow_outputs': []}, '4': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.3.4.3+galaxy0', 'errors': None, 'id': 4, 'input_connections': {'library|input_1': {'id': 2, 'output_name': 'out1'}, 'reference_genome|own_file': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [], 'label': None, 'name': 'Bowtie2', 'outputs': [{'name': 'output', 'type': 'bam'}, {'name': 'mapping_stats', 'type': 'txt'}], 'position': {'bottom': 563.7890472412109, 'height': 188.9701690673828, 'left': 452.64556884765625, 'right': 610.1455688476562, 'top': 374.8188781738281, 'width': 157.5, 'x': 452.64556884765625, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionmapping_stats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'mapping_stats'}, 'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.3.4.3+galaxy0', 'tool_shed_repository': {'changeset_revision': '749c918495f7', 'name': 'bowtie2', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__input_ext": "input", "__job_resource": {"__current_case__": 0, "__job_resource__select": "no"}, "analysis_type": {"analysis_type_selector": "simple", "__current_case__": 0, "presets": "--very-sensitive"}, "chromInfo": "/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len", "input_1|__identifier__": "SRR11247078", "library": {"type": "single", "__current_case__": 0, "input_1": {"__class__": "ConnectedValue"}, "unaligned_file": "false", "aligned_file": "false"}, "reference_genome": {"source": "history", "__current_case__": 1, "own_file": {"__class__": "ConnectedValue"}}, "rg": {"rg_selector": "do_not_set", "__current_case__": 3}, "sam_options": {"sam_options_selector": "no", "__current_case__": 1}, "save_mapping_stats": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '26c0ed71-d0e3-4955-81e7-083f8ee9fa24', 'workflow_outputs': []}, '5': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'errors': None, 'id': 5, 'input_connections': {'inputFile': {'id': 4, 'output_name': 'output'}}, 'inputs': [], 'label': None, 'name': 'MarkDuplicates', 'outputs': [{'name': 'metrics_file', 'type': 'txt'}, {'name': 'outFile', 'type': 'bam'}], 'position': {'bottom': 541.2890472412109, 'height': 166.4701690673828, 'left': 668.68603515625, 'right': 826.18603515625, 'top': 374.8188781738281, 'width': 157.5, 'x': 668.68603515625, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionmetrics_file': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'metrics_file'}, 'HideDatasetActionoutFile': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'outFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/devteam/picard/picard_MarkDuplicates/2.18.2.2', 'tool_shed_repository': {'changeset_revision': '7d34178f2812', 'name': 'picard', 'owner': 'devteam', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"__input_ext": "bam", "assume_sorted": "true", "barcode_tag": "", "chromInfo": "/cvmfs/data.galaxyproject.org/managed/len/ucsc/?.len", "comments": [], "duplicate_scoring_strategy": "SUM_OF_BASE_QUALITIES", "inputFile": {"__class__": "ConnectedValue"}, "inputFile|__identifier__": "SRR11247078", "optical_duplicate_pixel_distance": "100", "read_name_regex": "", "remove_duplicates": "true", "validation_stringency": "LENIENT", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '8783c6a8-39b8-4e65-bbfa-6d8d5b4c63f3', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'errors': None, 'id': 6, 'input_connections': {'reads': {'id': 5, 'output_name': 'outFile'}, 'reference_source|ref': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [{'description': 'runtime parameter for tool Realign reads', 'name': 'reads'}, {'description': 'runtime parameter for tool Realign reads', 'name': 'reference_source'}], 'label': None, 'name': 'Realign reads', 'outputs': [{'name': 'realigned', 'type': 'bam'}], 'position': {'bottom': 496.28904724121094, 'height': 121.47016906738281, 'left': 884.66259765625, 'right': 1042.16259765625, 'top': 374.8188781738281, 'width': 157.5, 'x': 884.66259765625, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionrealigned': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'realigned'}, 'RenameDatasetActionrealigned': {'action_arguments': {'newname': 'Realigned Alignments'}, 'action_type': 'RenameDatasetAction', 'output_name': 'realigned'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_viterbi/lofreq_viterbi/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'cdaab621d454', 'name': 'lofreq_viterbi', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"adv_options": {"delflags": "true", "bq2_handling": {"replace_bq2": "keep", "__current_case__": 0, "defqual": "2"}}, "reads": {"__class__": "RuntimeValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "RuntimeValue"}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '8605e3b4-3946-4f15-8024-418822d01f35', 'workflow_outputs': []}, '7': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'errors': None, 'id': 7, 'input_connections': {'results_0|software_cond|input': {'id': 2, 'output_name': 'report_json'}, 'results_1|software_cond|input': {'id': 4, 'output_name': 'mapping_stats'}, 'results_2|software_cond|output_0|input': {'id': 5, 'output_name': 'metrics_file'}}, 'inputs': [], 'label': None, 'name': 'MultiQC', 'outputs': [{'name': 'stats', 'type': 'input'}, {'name': 'plots', 'type': 'input'}, {'name': 'html_report', 'type': 'html'}], 'position': {'bottom': 736.2996978759766, 'height': 218.9701690673828, 'left': 884.66259765625, 'right': 1042.16259765625, 'top': 517.3295288085938, 'width': 157.5, 'x': 884.66259765625, 'y': 517.3295288085938}, 'post_job_actions': {'HideDatasetActionplots': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'plots'}, 'HideDatasetActionstats': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'stats'}, 'RenameDatasetActionhtml_report': {'action_arguments': {'newname': 'MultiQC Report SE'}, 'action_type': 'RenameDatasetAction', 'output_name': 'html_report'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/multiqc/multiqc/1.7.1', 'tool_shed_repository': {'changeset_revision': '3d93dd18d9f8', 'name': 'multiqc', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"comment": "", "flat": "false", "results": [{"__index__": 0, "software_cond": {"software": "fastp", "__current_case__": 7, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 1, "software_cond": {"software": "bowtie2", "__current_case__": 3, "input": {"__class__": "ConnectedValue"}}}, {"__index__": 2, "software_cond": {"software": "picard", "__current_case__": 17, "output": [{"__index__": 0, "type": "markdups", "input": {"__class__": "ConnectedValue"}}]}}], "saveLog": "false", "title": "", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f2ab1b33-e486-46a3-a1f7-e7dfcb3fbd8f', 'workflow_outputs': [{'label': 'MultiQC Report SE', 'output_name': 'html_report', 'uuid': '1d8108bd-3aa7-47a1-829e-1d9ec62c724c'}]}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/2.1.4+galaxy0', 'errors': None, 'id': 8, 'input_connections': {'reads': {'id': 6, 'output_name': 'realigned'}, 'strategy|reference_source|ref': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [{'description': 'runtime parameter for tool Insert indel qualities', 'name': 'reads'}], 'label': None, 'name': 'Insert indel qualities', 'outputs': [{'name': 'output', 'type': 'bam'}], 'position': {'bottom': 496.28904724121094, 'height': 121.47016906738281, 'left': 1100.703125, 'right': 1258.203125, 'top': 374.8188781738281, 'width': 157.5, 'x': 1100.703125, 'y': 374.8188781738281}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Realigned Alignments with Indel Qualities'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_indelqual/lofreq_indelqual/2.1.4+galaxy0', 'tool_shed_repository': {'changeset_revision': 'c27549b9aa1f', 'name': 'lofreq_indelqual', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"reads": {"__class__": "RuntimeValue"}, "strategy": {"selector": "dindel", "__current_case__": 1, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "RuntimeValue"}}}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'f9351146-3b2c-4fd6-bc49-0dfc25f1ac49', 'workflow_outputs': [{'label': 'Realigned Alignments with Indel Qualities', 'output_name': 'output', 'uuid': '56679e2f-441a-4195-95ee-00bf422e0e18'}]}, '9': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy1', 'errors': None, 'id': 9, 'input_connections': {'reads': {'id': 8, 'output_name': 'output'}, 'reference_source|ref': {'id': 3, 'output_name': 'output_fasta'}}, 'inputs': [{'description': 'runtime parameter for tool Call variants', 'name': 'reads'}, {'description': 'runtime parameter for tool Call variants', 'name': 'reference_source'}], 'label': None, 'name': 'Call variants', 'outputs': [{'name': 'variants', 'type': 'vcf'}], 'position': {'bottom': 466.28904724121094, 'height': 91.47016906738281, 'left': 1316.7222900390625, 'right': 1474.2222900390625, 'top': 374.8188781738281, 'width': 157.5, 'x': 1316.7222900390625, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionvariants': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'variants'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/lofreq_call/lofreq_call/2.1.3.1+galaxy1', 'tool_shed_repository': {'changeset_revision': 'dfadc322b065', 'name': 'lofreq_call', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"call_control": {"set_call_options": "yes", "__current_case__": 1, "coverage": {"min_cov": "100", "max_depth": "1000000"}, "pe": {"use_orphan": "false"}, "bc_quals": {"min_bq": "30", "min_alt_bq": "30", "alt_bq": {"modify": "", "__current_case__": 0}}, "align_quals": {"alnqual": {"use_alnqual": "", "__current_case__": 0, "alnqual_choice": {"alnquals_to_use": "", "__current_case__": 1, "extended_baq": "true"}}}, "map_quals": {"min_mq": "20", "use_mq": {"no_mq": "", "__current_case__": 0, "max_mq": "255"}}, "source_qual": {"use_src_qual": {"src_qual": "", "__current_case__": 0}}, "joint_qual": {"min_jq": "0", "min_alt_jq": "0", "def_alt_jq": "0"}}, "filter_control": {"filter_type": "set_lofreq_standard", "__current_case__": 2, "sig": "0.01", "bonf": "dynamic", "others": ""}, "reads": {"__class__": "RuntimeValue"}, "reference_source": {"ref_selector": "history", "__current_case__": 1, "ref": {"__class__": "RuntimeValue"}}, "regions": {"restrict_to_region": "genome", "__current_case__": 0}, "variant_types": "--call-indels", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '4d254eae-5f7c-437e-92ec-004373aa2c99', 'workflow_outputs': []}, '10': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'errors': None, 'id': 10, 'input_connections': {'input': {'id': 9, 'output_name': 'variants'}, 'snpDb|snpeff_db': {'id': 3, 'output_name': 'snpeff_output'}}, 'inputs': [{'description': 'runtime parameter for tool SnpEff eff:', 'name': 'intervals'}, {'description': 'runtime parameter for tool SnpEff eff:', 'name': 'transcripts'}], 'label': None, 'name': 'SnpEff eff:', 'outputs': [{'name': 'snpeff_output', 'type': 'vcf'}, {'name': 'statsFile', 'type': 'html'}], 'position': {'bottom': 578.7890472412109, 'height': 203.9701690673828, 'left': 1532.7200927734375, 'right': 1690.2200927734375, 'top': 374.8188781738281, 'width': 157.5, 'x': 1532.7200927734375, 'y': 374.8188781738281}, 'post_job_actions': {'HideDatasetActionsnpeff_output': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'snpeff_output'}, 'RenameDatasetActionstatsFile': {'action_arguments': {'newname': 'SnpEFF HTML stats'}, 'action_type': 'RenameDatasetAction', 'output_name': 'statsFile'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpeff/snpEff/4.3+T.galaxy1', 'tool_shed_repository': {'changeset_revision': '5a29ab10dba6', 'name': 'snpeff', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"annotations": ["-formatEff", "-classic"], "chr": "", "csvStats": "false", "filter": {"specificEffects": "no", "__current_case__": 0}, "filterOut": ["-no-downstream", "-no-intergenic", "-no-intron", "-no-upstream", "-no-utr"], "generate_stats": "true", "input": {"__class__": "ConnectedValue"}, "inputFormat": "vcf", "intervals": {"__class__": "RuntimeValue"}, "noLog": "true", "offset": "default", "outputConditional": {"outputFormat": "vcf", "__current_case__": 0}, "snpDb": {"genomeSrc": "custom", "__current_case__": 3, "snpeff_db": {"__class__": "ConnectedValue"}, "codon_table": "Standard"}, "spliceRegion": {"setSpliceRegions": "no", "__current_case__": 0}, "spliceSiteSize": null, "transcripts": {"__class__": "RuntimeValue"}, "udLength": "0", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '9f29985d-5598-4b21-990d-dc74dc51b3b3', 'workflow_outputs': [{'label': 'SnpEFF HTML stats', 'output_name': 'statsFile', 'uuid': '9b9ee0e2-f169-4a49-a4b1-b4fd0a66ea1d'}]}, '11': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'errors': None, 'id': 11, 'input_connections': {'input': {'id': 10, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'SnpSift Extract Fields', 'outputs': [{'name': 'output', 'type': 'tabular'}], 'position': {'bottom': 488.78904724121094, 'height': 113.97016906738281, 'left': 1748.6966552734375, 'right': 1906.1966552734375, 'top': 374.8188781738281, 'width': 157.5, 'x': 1748.6966552734375, 'y': 374.8188781738281}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift tabular output'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/iuc/snpsift/snpSift_extractFields/4.3+t.galaxy0', 'tool_shed_repository': {'changeset_revision': '09d6806c609e', 'name': 'snpsift', 'owner': 'iuc', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"empty_text": ".", "extract": "CHROM POS REF ALT QUAL DP AF SB DP4 EFF[*].IMPACT EFF[*].FUNCLASS EFF[*].EFFECT EFF[*].GENE EFF[*].CODON", "input": {"__class__": "ConnectedValue"}, "one_effect_per_line": "false", "separator": ",", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': '887e714b-753d-4789-8a81-5b1eecf6ddec', 'workflow_outputs': [{'label': 'SnpSift tabular output', 'output_name': 'output', 'uuid': '56c28896-40e5-4170-a68b-0b2bf3cbd915'}]}, '12': {'annotation': '', 'content_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'errors': None, 'id': 12, 'input_connections': {'input1': {'id': 10, 'output_name': 'snpeff_output'}}, 'inputs': [], 'label': None, 'name': 'Convert VCF to VCF_BGZIP', 'outputs': [{'name': 'output1', 'type': 'vcf_bgzip'}], 'position': {'bottom': 593.7464141845703, 'height': 83.97016906738281, 'left': 1748.6966552734375, 'right': 1906.1966552734375, 'top': 509.7762451171875, 'width': 157.5, 'x': 1748.6966552734375, 'y': 509.7762451171875}, 'post_job_actions': {'RenameDatasetActionoutput1': {'action_arguments': {'newname': 'SnpEff vcf.gz'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output1'}}, 'tool_id': 'CONVERTER_vcf_to_vcf_bgzip_0', 'tool_state': '{"input1": {"__class__": "ConnectedValue"}, "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': None, 'type': 'tool', 'uuid': 'b37f2eb6-c107-4ba4-b5b5-2d3d765c2149', 'workflow_outputs': [{'label': 'SnpEff vcf.gz', 'output_name': 'output1', 'uuid': 'c5a7bf3e-b5a4-4c31-bbe4-40ad915c87f5'}]}}, 'tags': '', 'uuid': '8ef65f5d-2d1a-419b-a118-a32fa9aa6245'}, 'tool_id': '3ca54d61de465711', 'type': 'subworkflow', 'uuid': '8656efd5-16d3-4890-b1f3-228f4940ce38', 'workflow_outputs': [{'label': 'MultiQC Report SE', 'output_name': 'MultiQC Report SE', 'uuid': 'eefcf4e7-35f1-4851-b27a-df1a42c80abc'}, {'label': 'SnpEFF HTML stats', 'output_name': 'SnpEFF HTML stats', 'uuid': '0e5e82c4-06e6-4a14-bf08-dbbacf007706'}, {'label': 'Realigned Alignments with Indel Qualities', 'output_name': 'Realigned Alignments with Indel Qualities', 'uuid': 'bab42abd-5d36-424c-bdce-0df162331e11'}, {'label': 'SnpEff vcf.gz', 'output_name': 'SnpEff vcf.gz', 'uuid': '5a9055e8-eede-463b-83ca-e671dbef9f6d'}, {'label': 'SnpSift tabular output', 'output_name': 'SnpSift tabular output', 'uuid': '125bdc63-37ab-4013-b6f6-53b51c02b9f9'}]}, '5': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 5, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'SnpSift tabular output'}, 'inputs_1|input': {'id': 4, 'output_name': 'SnpSift tabular output'}}, 'inputs': [], 'label': 'Merge SnpSift collection', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1058.0255432128906, 'top': 200.00000762939453}, 'post_job_actions': {'HideDatasetActionoutput': {'action_arguments': {}, 'action_type': 'HideDatasetAction', 'output_name': 'output'}, 'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged SnpSift tables'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.0.0', 'type': 'tool', 'uuid': 'eba9a0b3-6220-4156-ac00-d84b224cab80', 'workflow_outputs': []}, '6': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 6, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'SnpEff vcf.gz'}, 'inputs_1|input': {'id': 4, 'output_name': 'SnpEff vcf.gz'}}, 'inputs': [], 'label': 'Merge SnpEff vcf.gz collection', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1058.0255432128906, 'top': 409.9999771118164}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged SnpEff vcf'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.0.0', 'type': 'tool', 'uuid': 'f6ca3a81-cc70-4903-959c-308666b55e10', 'workflow_outputs': [{'label': 'Merged SnpEff vcf', 'output_name': 'output', 'uuid': '100ada3a-ba3f-4d39-88fd-240d52312754'}]}, '7': {'annotation': '', 'content_id': '__MERGE_COLLECTION__', 'errors': None, 'id': 7, 'input_connections': {'inputs_0|input': {'id': 3, 'output_name': 'Realigned Alignments with Indel Qualities'}, 'inputs_1|input': {'id': 4, 'output_name': 'Realigned Alignments with Indel Qualities'}}, 'inputs': [], 'label': 'Merge realigned BAM files', 'name': 'Merge Collections', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1058.0255432128906, 'top': 620.0141983032227}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'Merged realigned BAM'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': '__MERGE_COLLECTION__', 'tool_state': '{"advanced": {"conflict": {"duplicate_options": "keep_first", "__current_case__": 3}}, "inputs": [{"__index__": 0, "input": {"__class__": "ConnectedValue"}}, {"__index__": 1, "input": {"__class__": "ConnectedValue"}}], "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '1.0.0', 'type': 'tool', 'uuid': '034a6308-2b20-4aed-aaa4-93cdf0e6a68d', 'workflow_outputs': [{'label': 'Merged realigned BAM', 'output_name': 'output', 'uuid': '37823e90-c6a3-41d9-9a7a-1f70fe3450eb'}]}, '8': {'annotation': '', 'content_id': 'toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2', 'errors': None, 'id': 8, 'input_connections': {'input_list': {'id': 5, 'output_name': 'output'}}, 'inputs': [], 'label': 'SnpSift summary table', 'name': 'Collapse Collection', 'outputs': [{'name': 'output', 'type': 'input'}], 'position': {'left': 1344.0340881347656, 'top': 200.00000762939453}, 'post_job_actions': {'RenameDatasetActionoutput': {'action_arguments': {'newname': 'SnpSift summary table'}, 'action_type': 'RenameDatasetAction', 'output_name': 'output'}}, 'tool_id': 'toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2', 'tool_shed_repository': {'changeset_revision': '830961c48e42', 'name': 'collapse_collections', 'owner': 'nml', 'tool_shed': 'toolshed.g2.bx.psu.edu'}, 'tool_state': '{"filename": {"add_name": "true", "__current_case__": 0, "place_name": "same_multiple"}, "input_list": {"__class__": "ConnectedValue"}, "one_header": "true", "__page__": null, "__rerun_remap_job_id__": null}', 'tool_version': '4.2', 'type': 'tool', 'uuid': '68a39519-bd7e-4af8-a93f-f216ee69b2a6', 'workflow_outputs': [{'label': 'SnpSift summary table', 'output_name': 'output', 'uuid': '0b7a2051-9dd7-4d0f-9dd7-f2a30f7e94c7'}]}}, 'tags': [], 'uuid': '0cdc90a9-887f-4866-abe2-665348894562', 'version': 4}


@click.command("Run Download and SE+PE Illumina Covid Variation Workflow workflow")
@click.option("--nc_45512_genbank_file", type=click.Path(exists=True))
@click.option("--accessions_file", type=click.Path(exists=True))
@click.option('-a', '--api_key', help="API key to use for running workflow")
@click.option('-g', '--galaxy_url', default="https://usegalaxy.org", help="Galaxy URL to use for running workflow", show_default=True)
@click.option('-h', '--history_id', help="History ID that will contain workflow results")
@click.option('-n', '--new_history_name', help="Create a new history with this name. Will not be used if history ID is provided.")
@click.option('--publish/--private', default=False, help="Publish history?")
@click.option('--monitor_invocation/--no_monitor_invocation', default=False, help="Print workflow invocation status updates?")
@click.option('--workflow_id_override', default=None, help="Override workflow to run with this workflow id or uuid")
@click.option('--quiet', default=False, help='Decrease logging output')
def run_download_and_se_pe_illumina_covid_variation_workflow(nc_45512_genbank_file, accessions_file, api_key, galaxy_url, history_id, new_history_name, publish, monitor_invocation, workflow_id_override, quiet):
    """
    Run Download and SE+PE Illumina Covid Variation Workflow workflow

    Downloads reads from SRA and runs SE and PE COVID-19 variation workflows
    """
    if quiet:
        log.setLevel(logging.ERROR)
    gi = bioblend.galaxy.GalaxyInstance(galaxy_url, api_key)
    workflow_id = workflow_id_override or '0cdc90a9-887f-4866-abe2-665348894562'
    try:
        gi.workflows.show_workflow(workflow_id)
    except Exception:
        if FULL_WORKFLOW:
            gi.workflows.import_workflow_dict(FULL_WORKFLOW)
            log.info("Imported workflow")
        else:
            raise Exception("Workflow with id '%s' not uploaded or not accessible" % workflow_id)
    if history_id is None:
        if new_history_name is None:
            new_history_name = 'History for Download and SE+PE Illumina Covid Variation Workflow execution'
        history = gi.histories.create_history(name=new_history_name)
    else:
        history = gi.histories.show_history(history_id)
    history_id = history['id']
    if publish:
        history = gi.histories.update_history(history_id, published=True, importable=True)
        history_url = urljoin(galaxy_url, history['username_and_slug'])
    else:
        history_url = urljoin(galaxy_url, "histories/view?id=%s" % history_id)
    # This will look a bit awkward,
    # those could become custom click types
    datasets_to_upload = [nc_45512_genbank_file, accessions_file]
    upload_paths = {}
    for dataset in datasets_to_upload:
        log.info("Uploading dataset '%s' to history %s", dataset, history_url)
        r = gi.tools.upload_file(path=dataset, history_id=history_id, to_posix_lines=False)
        upload_paths[dataset] = {'src': 'hda', 'id': r['outputs'][0]['id']}
    inputs = {
        'NC_45512 GenBank file': upload_paths.get(nc_45512_genbank_file, nc_45512_genbank_file),
        'Accessions file': upload_paths.get(accessions_file, accessions_file),
    }
    invocation = run_workflow(gi, workflow_id, history_id, inputs)
    assert invocation['state'] == 'new', "Expected invocation state to be 'new', but invocation is %s" % invocation
    log.info("Workflow '%s' started with invocation id '%s'. Results will appear in history %s", workflow_id, invocation['id'], history_url)
    if monitor_invocation:
        im = InvocationMonitor(gi)
        im.monitor_invocation(invocation['id'])


def run_workflow(gi, workflow_id, history_id, inputs):
    r = gi.workflows.invoke_workflow(
        workflow_id,
        inputs=inputs,
        history_id=history_id,
        inputs_by='name',
    )
    return r


if __name__ == '__main__':
    run_download_and_se_pe_illumina_covid_variation_workflow()